{% extends "base.html" %}
{% load i18n %}
{% load static %}
{% load app_filters %}

{% block title %}{% trans "Thesaurus" %} | {{ block.super }}{% endblock %}

{% block breadcrumb %}
    {% if object %}
        <li>
            <a href="{% url 'list_qualifier' %}?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}">
                {% trans "Thesaurus" %}
                {% if choiced_thesaurus_name %}
                    {% for obj in choiced_thesaurus_name %}
                        {{ obj.thesaurus_name }}
                    {% endfor %}
                {% endif %}
            </a>
            <span class="divider">/</span>
        </li>
        <li>{% trans "Edit Qualifier" %}</li>
    {% endif %}
{% endblock %}

{% block content %}

    <style rel="stylesheet" type="text/css">
        .float-banner {
            position: absolute;
            left: 95%;
            width: 350px; height: 100px;
            margin-top: 25px; margin-left: -300px;
        }

        .tb_concept_preferred {
            background-color: #FAFAD2;
        }

        .tb_concept {
            background-color: #F5F5F5;
        }

        a[href="#top"]{
            padding:10px;
            position:fixed;
            top: 75%;
            right:40px;
            display:none;
            font-size: 20px;
        }
        a[href="#top"]:hover{
            text-decoration:none;
        }

    </style>

    <div class='header'>
        <table width="98%">
            <tr>
                <td valign="top" width="20%">
                    <h2><i class='icon-file'></i> {% trans "Qualifiers" %}</h2>
                </td>
                <td valign="top">
                    <ul>
                        {% for obj in term_string_info_preferred_objects %}
                            {% if obj.termqualif__status == 1 %}
                                {{ obj.termqualif__term_string }} <font color="blue">({{ obj.termqualif__language_code }})</font><br>
                            {% endif %}
                        {% endfor %}
                    </ul>
                </td>

                <div id="float-banner" class="float-banner">
                    <form name="f1" action="" onSubmit="if(this.t1.value!=null && this.t1.value!='') findString(this.t1.value);return false">
                        <input type="text" id="id_t1" name=t1 value="" size=20 placeholder="{% trans "Search" %}">
                        <input type="hidden" name=ths value="{% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}">
                        <button class="btn btn-primary" type="submit" style="margin-top: -10px"><i class="icon-search"></i></button>
                        <button class="btn btn-primary" type="reset" style="margin-top: -10px"><i class="icon-refresh"></i></button>
                    </form>
                </div>

            </tr>
        </table>
    </div>

    <div class='body'>

        <ul class="nav nav-tabs" id='myTab'>
            <li class="active">
                <a href="#tab-details" data-toggle="tab"><strong>{% trans "Details" %}</strong></a>
            </li>

            <li>
                <a href="#tab-concepts" data-toggle="tab"><strong>{% trans "Concepts" %}</strong></a>
            </li>

            <!-- Legacy information -->
            {% if request.GET.ths = '1' %}
            <li>
                <a href="#tab-legacy" data-toggle="tab"><strong>{% trans "Set exclusive to BIREME" %}</strong></a>
            </li>
            {% endif %}

        </ul>

        <div class="tab-content">
            <div id="tab-details" class="tab-pane active">
                <table width="95%">
                    <tr>
                        <td valign="top" align="right" width="15%"><b>{% trans "Qualifier record" %}</b></td>
                        <td>&nbsp;&nbsp;</td>
                        <td valign="top">
                        {% for obj in term_string_info_preferred_objects %}
                            {% if obj.termqualif__status == 1 %}
                                {{ obj.termqualif__term_string }} <font color="blue">({{ obj.termqualif__language_code }})</font>
                                <a href="{% url 'edit_register_qualif' obj.identifier_id %}/?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}&string={{ obj.termqualif__term_string }}&lang={{obj.termqualif__language_code}}" title="{% trans "Edit record information, abbreviation, hierarchical codes and descriptions" %}"><i class="icon-pencil"></i></a>
                                <br>
                            {% endif %}
                        {% endfor %}
                        </td>
                    </tr>

                    <tr>
                        <td valign="top" align="right" width="15%"><b>{% trans "Tree Number(s)" %}</b></td>
                        <td>&nbsp;&nbsp;</td>
                        <td valign="top">
                        {% for obj in tree_numbers_objects %}
                            {% if obj.qtreenumbers__tree_number %}
                                {{ obj.qtreenumbers__tree_number }}<br>
                            {% endif %}
                        {% endfor %}
                        </td>
                    </tr>

                    <tr>
                        <td valign="top" align="right" width="15%"><b>{% trans "Unique ID" %}</b></td>
                        <td>&nbsp;&nbsp;</td>
                        <td valign="top">
                        {% for obj in id_register_objects %}
                            {% ifchanged %}
                                {{ obj.qualifier_ui }}
                            {% endifchanged %}
                        {% endfor %}
                        </td>
                    </tr>

                    <tr>
                        <td valign="top" align="right" width="15%"><b>{% trans "Thesaurus ID" %}</b></td>
                        <td>&nbsp;&nbsp;</td>
                        <td valign="top">
                        {% for obj in id_register_objects %}
                            {% ifchanged %}
                                {{ obj.decs_code }}
                            {% endifchanged %}
                        {% endfor %}
                        </td>
                    </tr>

                    <tr>
                        <td valign="top" align="right" width="15%"><b>{% trans "Indexing Annotation" %}</b></td>
                        <td>&nbsp;&nbsp;</td>
                        <td valign="top">
                            <table class="table table-striped">
                            {% for obj in description_objects %}
                                {% ifchanged %}
                                    {% if obj.descriptionqualif__annotation %}
                                    <tr>
                                        <td width="8%">
                                            <font color="blue">{{ obj.descriptionqualif__language_code }}</font>
                                        </td>
                                        <td>
                                            {{ obj.descriptionqualif__annotation }}
                                        </td>
                                    </tr>
                                    {% endif %}
                                {% endifchanged %}
                            {% endfor %}
                            </table>
                        </td>
                    </tr>

                    <tr>
                        <td valign="top" align="right" width="15%"><b>{% trans "Definition" %}</b></td>
                        <td>&nbsp;&nbsp;</td>
                        <td valign="top">
                            <table class="table table-striped">
                            {% for obj in scope_note_objects %}
                                {% if obj.conceptqualif__scope_note %}
                                    {% ifchanged %}
                                    <tr>
                                        <td width="8%">
                                            <font color="blue">{{ obj.conceptqualif__language_code }}</font>
                                        </td>
                                        <td>
                                        {{ obj.conceptqualif__scope_note }}
                                        </td>
                                    </tr>
                                    {% endifchanged %}
                                {% endif %}
                            {% endfor %}
                            </table>
                        </td>
                    </tr>

                    <tr>
                        <td valign="top" align="right" width="15%"><b>{% trans "Abbreviation" %}</b></td>
                        <td>&nbsp;&nbsp;</td>
                        <td valign="top">
                        {% for obj in id_register_objects %}
                            {% if obj.abbreviation %}
                                {% ifchanged %}
                                    {{ obj.abbreviation }}<br>
                                {% endifchanged %}
                            {% endif %}
                        {% endfor %}
                        </td>
                    </tr>

                    <tr>
                        <td valign="top" align="right" width="15%"><b>{% trans "Entry Term(s)" %}</b></td>
                        <td>&nbsp;&nbsp;</td>
                        <td valign="top">

                        {% regroup entry_terms_objects by termqualif__language_code as entry_terms_objects_list %}

                        <table  class="table table-striped">

                        {% for termqualif__language_code in entry_terms_objects_list %}
                            <tr>
                                <td width="8%">
                                    <font color="blue">{{ termqualif__language_code.grouper }}</font>
                                </td>
                                <td>
                                    {% for obj in termqualif__language_code.list %}
                                        {% if obj.termqualif__status != -3 %}
                                            {{ obj.termqualif__term_string }}<br>
                                        {% endif %}
                                    {% endfor %}
                                </td>

                            </tr>

                        {% endfor %}

                        </table>

                        </td>
                    </tr>

                    <tr>
                        <td valign="top" align="right" width="15%"><b>{% trans "Pharmacological Action" %}</b></td>
                        <td>&nbsp;&nbsp;</td>
                        <td valign="top">
                            &nbsp;
                        </td>
                    </tr>

                    <tr>
                        <td valign="top" align="right" width="15%"><b>{% trans "Registry Number" %}</b></td>
                        <td>&nbsp;&nbsp;</td>
                        <td valign="top">
                        {% for obj in identifierconceptlist_objects_preferred %}
                            {% if obj.registry_number %}
                                {% ifchanged %}
                                    {{ obj.registry_number }}<br>
                                {% endifchanged %}
                            {% endif %}
                        {% endfor %}
                        </td>
                    </tr>

                    <!-- Related Numbers -->

                    <tr>
                        <td valign="top" align="right" width="15%"><b>{% trans "CAS Type 1 Name" %}</b></td>
                        <td>&nbsp;&nbsp;</td>
                        <td valign="top">
                        {% for obj in identifierconceptlist_objects_preferred %}
                            {% if obj.casn1_name %}
                                {% ifchanged %}
                                    {{ obj.casn1_name }}<br>
                                {% endifchanged %}
                            {% endif %}
                        {% endfor %}
                        </td>
                    </tr>

                    <tr>
                        <td valign="top" align="right" width="15%"><b>{% trans "Online Note" %}</b></td>
                        <td>&nbsp;&nbsp;</td>
                        <td valign="top">
                        {% for obj in description_objects %}
                            {% ifchanged %}
                                {% if obj.descriptionqualif__online_note %}
                                    {{ obj.descriptionqualif__online_note }} <font color="blue">({{ obj.descriptionqualif__language_code }})</font><br>
                                {% endif %}
                            {% endifchanged %}
                        {% endfor %}
                        </td>
                    </tr>

                    <tr>
                        <td valign="top" align="right" width="15%"><b>{% trans "History Note" %}</b></td>
                        <td>&nbsp;&nbsp;</td>
                        <td valign="top">
                        {% for obj in description_objects %}
                            {% ifchanged %}
                                {% if obj.descriptionqualif__history_note %}
                                    {{ obj.descriptionqualif__history_note }} <font color="blue">({{ obj.descriptionqualif__language_code }})</font><br>
                                {% endif %}
                            {% endifchanged %}
                        {% endfor %}
                        </td>
                    </tr>

                    <tr>
                        <td valign="top" align="right" width="15%"><b>{% trans "Date Established" %}</b></td>
                        <td>&nbsp;&nbsp;</td>
                        <td valign="top">
                        {% for obj in id_register_objects %}
                            {% ifchanged %}
                                {{ obj.date_established|default_if_none:"" }}
                            {% endifchanged %}
                        {% endfor %}
                        </td>
                    </tr>

                    <tr>
                        <td valign="top" align="right" width="15%"><b>{% trans "Date of Entry" %}</b></td>
                        <td>&nbsp;&nbsp;</td>
                        <td valign="top">
                        {% for obj in id_register_objects %}
                            {% ifchanged %}
                                {{ obj.date_created|default_if_none:"" }}
                            {% endifchanged %}
                        {% endfor %}
                        </td>
                    </tr>

                    <tr>
                        <td valign="top" align="right" width="15%"><b>{% trans "Revision Date" %}</b></td>
                        <td>&nbsp;&nbsp;</td>
                        <td valign="top">
                        {% for obj in id_register_objects %}
                            {% ifchanged %}
                                {{ obj.date_revised|default_if_none:"" }}
                            {% endifchanged %}
                        {% endfor %}
                        </td>
                    </tr>

                </table>

                <div class="btn-group pull-right">
                    <a href="#" data-toggle="modal" data-target="#log_modal" data-remote="/log/view/{{id_ctype_identifierqualif}}/{{id_identifierqualif}}/" class="btn"><i class="icon icon-time"></i> {% trans "Changes history" %}</a>
                </div>
                {% if object.id %}
                    {% include "modal_log.html" %}
                {% endif %}

                <a href="#top" class="glyphicon glyphicon-chevron-up"><i class="icon-arrow-up"></i></a>

            </div>

            <div id="tab-concepts" class="tab-pane">

                <ul>
                    <a href="{% url 'create_concept_qualif' %}/?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}&identifier_id={{ id_concept_new.identifier_id }}">
                    <i class='icon-file'></i>&nbsp;{% trans "Add concept" %}</a>
                </ul>

                {% for obj in identifierconceptlist_objects_preferred_for_concepts %}

                    <ul>

                        {% if forloop.counter == 1 %}

                            {% if obj.termqualif__concept_preferred_term == 'Y' %}
                                {% ifchanged obj.termqualif__identifier_concept_id %}

                                    <table width="100%" class="tb_concept_preferred">
                                        <tr>
                                            <td>

                                                <b>{% trans "Concept" %}</b>:
                                                {{ obj.termqualif__term_string }}&nbsp;<font color="blue">({{ obj.termqualif__language_code }})</font>
                                                <b>[ {{ obj.concept_ui }} ]</b>

                                {% endifchanged %}
                            {% endif %}

                            {% if obj.termqualif__concept_preferred_term == 'Y' and obj.preferred_concept == 'Y' and obj.termqualif__language_code %}

                                    <font color="blue"><i>&nbsp;{% trans "Preferred Concept" %}</i></font>
                                    <a href="{% url 'edit_concept_qualif' obj.id %}/?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}&string={{ obj.termqualif__term_string }}&lang={{obj.termqualif__language_code}}&id={{ obj.termqualif__id }}&identifier_id={{obj.identifier_id}}" title="{% trans "Edit concept information" %}"><i class="icon-pencil"></i></a>

                                    {% if identifierconceptlist_objects %}
                                        <a href="{% url 'list_concept_qualif' %}/?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}&identifier_concept_id={{ obj.termqualif__identifier_concept_id }}&term_string={{ obj.termqualif__term_string }}&language_code={{ obj.termqualif__language_code }}" title="{% trans "Move this concept to another record" %}"><i class="icon-share"></i>
                                        </a>
                                    {% endif %}

                                            </td>
                                        </tr>
                                    </table>

                            {% endif %}

                        {% endif %}
    
                        <ul>
                            {% ifchanged %}
                                <a href="{% url 'create_term_qualif' %}/?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}&identifier_concept_id={{ obj.termqualif__identifier_concept_id }}"><i class='icon-file'></i>&nbsp;{% trans "Add term" %}</a>
                             
                                <br>
                                <b>{% trans "Term" %}</b>:
                            {% endifchanged %}
                            
                            {% ifchanged obj.termqualif__language_code %} <!-- Faz a separação em grupo de UPs por idioma -->
                                {% if obj.termqualif__concept_preferred_term == 'N' %}
                                    <ul><hr></ul>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                    <font color="blue">{{ obj.termqualif__language_code }}</font>
                                {% endif %}
                            {% endifchanged %}

                            {% ifchanged obj.termqualif__id %}

                                <a class="accordion-toggle" data-toggle="collapse" data-target="#term_{{ obj.termqualif__id }}">
                                    {% if obj.termqualif__concept_preferred_term == 'Y' %}<ul>{% else %}<ul><ul>{% endif %}

                                    {{ obj.termqualif__term_string }}

                                    {% if obj.termqualif__concept_preferred_term == 'Y' %}<font color="blue">({{ obj.termqualif__language_code }})</font>{% endif %}
                                </a>
                                {% if obj.termqualif__concept_preferred_term == 'Y' %}
                                    <font color="blue"><i>&nbsp;{% trans "Preferred Term" %}</i></font>
                                {% endif %}

                                {% if obj.termqualif__status != -3 %}
                                    {% if obj.termqualif__status != 3 %}
                                        <a href="{% url 'edit_term_qualif' obj.termqualif__id %}/?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}&string={{ obj.termqualif__term_string }}&lang={{obj.termqualif__language_code}}&identifier_concept_id={{ obj.termqualif__identifier_concept_id }}" title="{% trans "Edit qualifier information" %}">
                                        <i class="icon-pencil"></i></a>

                                        {% if identifierconceptlist_objects_preferred|length > 1 %}
                                            {% if obj.termqualif__concept_preferred_term == 'N' %}
                                                <a href="{% url 'list_qualif' %}/?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}&term_id={{ obj.termqualif__id }}&term_string={{ obj.termqualif__term_string }}&language_code={{ obj.termqualif__language_code }}" title="{% trans "Move this qualifier to another concept" %}"><i class="icon-share"></i></a>

                                            <a href="{% url 'create_confirm_termqualif' %}/?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}&term_ui={{ obj.termqualif__term_ui }}&term_string={{ obj.termqualif__term_string }}&language_code={{ obj.termqualif__language_code }}&term_id={{ obj.termqualif__id }}" title="{% trans "Create a new record from this qualifier" %}"><i class="icon-plus-sign"></i></a>
                                            {% endif %}
                                        {% endif %}
                                    {% endif %}
                                {% endif %}

                                {{ obj.termqualif__status|display_status_label }}

                                <ul id="term_{{ obj.termqualif__id }}" class="collapse">
                                    {% if obj.termqualif__term_ui %}{% trans "Term UI" %}: {{ obj.termqualif__term_ui }}<br>{% endif %}
                                    {% if obj.termqualif__concept_preferred_term %}{% trans "ConceptPreferredTerm" %}: {{ obj.termqualif__concept_preferred_term }}<br>{% endif %}
                                    {% if obj.termqualif__is_permuted_term %}{% trans "Is permuted" %}: {{ obj.termqualif__is_permuted_term }}<br>{% endif %}
                                    {% if obj.termqualif__lexical_tag %}{% trans "LexicalTag" %}: {{ obj.termqualif__lexical_tag }}<br>{% endif %}
                                    {% if obj.termqualif__record_preferred_term %}{% trans "RecordPreferredTerm" %}: {{ obj.termqualif__record_preferred_term }}<br>{% endif %}
                                    {% if obj.termqualif__entry_version %}{% trans "Entry Version" %}: {{ obj.termqualif__entry_version }}<br>{% endif %}
                                    {% if obj.termqualif__date_created %}{% trans "DateCreated" %}: {{ obj.termqualif__date_created }}<br>{% endif %}
                                    {% if obj.termqualif__date_altered %}{% trans "DateAltered" %}: {{ obj.termqualif__date_altered }}<br>{% endif %}
                                    {% if obj.termqualif__historical_annotation %}{% trans "History annotation" %}: {{ obj.termqualif__historical_annotation }}<br>{% endif %}
                                </ul>

                                {% if obj.termqualif__concept_preferred_term == 'Y' %}</ul>{% else %}</ul></ul>{% endif %}

                            {% endifchanged %}
                        </ul>

                    </ul>

                {% endfor %}

                {% for obj in identifierconceptlist_objects_for_concepts %}

                    <ul>

                        {% ifchanged obj.termqualif__identifier_concept_id %}

                            {% if obj.termqualif__concept_preferred_term == 'Y' %}

                                <hr>
                                <table width="100%" class="tb_concept">
                                    <tr>
                                        <td>

                                            <b>{% trans "Concept" %}</b>:
                                            {{ obj.termqualif__term_string }}&nbsp;<font color="blue">({{ obj.termqualif__language_code }})</font>
                                            <b>[ {{ obj.concept_ui }} ]</b>

                                            <font color="gray"><i>&nbsp;{% trans "Narrower" %}
                                                {% if obj.termqualif__status == '3' %}
                                                    {{ obj.termqualif__status|display_status_label }}
                                                {% endif %}
                                            </i></font>

                                            {% if identifierconceptlist_objects_preferred|length == 0 %}
                                            <!-- force preferred_concept=N -->
                                                <a href="{% url 'edit_concept_qualif' obj.id %}/?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}&string={{ obj.termqualif__term_string }}&lang={{obj.termqualif__language_code}}&id={{ obj.termqualif__id }}&identifier_id={{obj.identifier_id}}" title="{% trans "Edit concept information" %}"><i class="icon-pencil"></i></a>
                                            {% else %}
                                                <a href="{% url 'edit_concept_qualif' obj.id %}/?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}&string={{ obj.termqualif__term_string }}&lang={{obj.termqualif__language_code}}&id={{ obj.termqualif__id }}&identifier_id={{obj.identifier_id}}&preferred_concept=N" title="{% trans "Edit concept information" %}"><i class="icon-pencil"></i></a>
                                            {% endif %}

                                            <a href="{% url 'list_concept_qualif' %}/?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}&identifier_concept_id={{ obj.termqualif__identifier_concept_id }}&term_string={{ obj.termqualif__term_string }}&language_code={{ obj.termqualif__language_code }}" title="{% trans "Move this concept to another record" %}"><i class="icon-share"></i>

                                            <a href="{% url 'create_confirm_conceptqualif' %}/?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}&term_string={{ obj.termqualif__term_string }}&language_code={{ obj.termqualif__language_code }}&concept_id={{ obj.id }}&term_id={{ obj.termqualif__id }}&created_by={{ user_id }}&thesaurus_name={% if choiced_thesaurus_name %}{% for obj in choiced_thesaurus_name %}{{ obj.thesaurus_name }}{% endfor %}{% endif %}" title="{% trans "Create a new record from this concept" %}"><i class="icon-plus-sign"></i></a>

                                            </td>
                                        </tr>
                                </table>


                            {% else %}

                                <hr>
                                <table width="100%" class="tb_concept">
                                    <tr>
                                        <td>
                                            <b>{% trans "Concept" %}</b>:&nbsp;<font color="red"><b>{% trans "Please set the preferred term for this concept" %}</b></font>&nbsp;<b>[ {{ obj.concept_ui }} ]</b>
                                        </td>
                                    </tr>
                                </table>

                            {% endif %}

                        {% endifchanged %}

                        <ul>

                        {% ifchanged %}
                            <!-- force record_preferred_term=N -->
                            <a href="{% url 'create_term_qualif' %}/?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}&identifier_concept_id={{ obj.termqualif__identifier_concept_id }}&record_preferred_term=N"><i class='icon-file'></i>&nbsp;{% trans "Add term" %}</a>
                         
                            <br>
                            <b>{% trans "Term" %}</b>:
                        {% endifchanged %}
                        
                        {% ifchanged obj.termqualif__language_code %} <!-- Faz a separação em grupo de UPs por idioma -->
                            {% if obj.termqualif__concept_preferred_term == 'N' %}
                                <ul><hr></ul>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                <font color="blue">{{ obj.termqualif__language_code }}</font>
                            {% endif %}
                        {% endifchanged %}

                        {% ifchanged obj.termqualif__id %}

                            <a class="accordion-toggle" data-toggle="collapse" data-target="#term_{{ obj.termqualif__id }}">
                                {% if obj.termqualif__concept_preferred_term == 'Y' %}<ul>{% else %}<ul><ul>{% endif %}

                                {{ obj.termqualif__term_string }}

                                {% if obj.termqualif__concept_preferred_term == 'Y' %}<font color="blue">({{ obj.termqualif__language_code }})</font>{% endif %}
                            </a>
                            {% if obj.termqualif__concept_preferred_term == 'Y' %}
                                <font color="blue"><i>&nbsp;{% trans "Preferred Term" %}</i></font>
                            {% endif %}

                            {% if obj.termqualif__status != -3 %}
                                {% if obj.termqualif__status != 3 %}
                                    <!-- force record_preferred_term=N -->
                                    <a href="{% url 'edit_term_qualif' obj.termqualif__id %}/?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}&string={{ obj.termqualif__term_string }}&lang={{obj.termqualif__language_code}}&identifier_concept_id={{ obj.termqualif__identifier_concept_id }}&record_preferred_term=N" title="{% trans "Edit qualifier information" %}">
                                    <i class="icon-pencil"></i></a>

                                    {% if identifierconceptlist_objects|length > 1 %}
                                        {% if obj.termqualif__concept_preferred_term == 'N' %}
                                            <a href="{% url 'list_qualif' %}/?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}&term_id={{ obj.termqualif__id }}&term_string={{ obj.termqualif__term_string }}&language_code={{ obj.termqualif__language_code }}" title="{% trans "Move this qualifier to another concept" %}"><i class="icon-share"></i></a>

                                            <a href="{% url 'create_confirm_termqualif' %}/?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}&term_ui={{ obj.termqualif__term_ui }}&term_string={{ obj.termqualif__term_string }}&language_code={{ obj.termqualif__language_code }}&term_id={{ obj.termqualif__id }}" title="{% trans "Create a new record from this qualifier" %}"><i class="icon-plus-sign"></i></a>
                                        {% endif %}
                                    {% endif %}
                                {% endif %}
                            {% endif %}

                            {{ obj.termqualif__status|display_status_label }}

                            <ul id="term_{{ obj.termqualif__id }}" class="collapse">
                                {% if obj.termqualif__term_ui %}{% trans "Term UI" %}: {{ obj.termqualif__term_ui }}<br>{% endif %}
                                {% if obj.termqualif__concept_preferred_term %}{% trans "ConceptPreferredTerm" %}: {{ obj.termqualif__concept_preferred_term }}<br>{% endif %}
                                {% if obj.termqualif__is_permuted_term %}{% trans "Is permuted" %}: {{ obj.termqualif__is_permuted_term }}<br>{% endif %}
                                {% if obj.termqualif__lexical_tag %}{% trans "LexicalTag" %}: {{ obj.termqualif__lexical_tag }}<br>{% endif %}
                                {% if obj.termqualif__record_preferred_term %}{% trans "RecordPreferredTerm" %}: {{ obj.termqualif__record_preferred_term }}<br>{% endif %}
                                {% if obj.termqualif__entry_version %}{% trans "Entry Version" %}: {{ obj.termqualif__entry_version }}<br>{% endif %}
                                {% if obj.termqualif__date_created %}{% trans "DateCreated" %}: {{ obj.termqualif__date_created }}<br>{% endif %}
                                {% if obj.termqualif__date_altered %}{% trans "DateAltered" %}: {{ obj.termqualif__date_altered }}<br>{% endif %}
                                {% if obj.termqualif__historical_annotation %}{% trans "History annotation" %}: {{ obj.termqualif__historical_annotation }}<br>{% endif %}
                            </ul>

                            {% if obj.termqualif__concept_preferred_term == 'Y' %}</ul>{% else %}</ul></ul>{% endif %}

                        {% endifchanged %}
                        </ul>

                    </ul>

                {% endfor %}

                <a href="#top" class="glyphicon glyphicon-chevron-up"><i class="icon-arrow-up"></i></a>

            </div>

            <div id="tab-legacy" class="tab-pane">

                {% if legacy_objects %}
                    {% for obj in legacy_objects %}

                    <ul>
                        <a href="{% url 'edit_legacy_qualif' obj.id %}/?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}&identifier_id={{obj.identifier_id}}"><i class="icon-pencil"></i>&nbsp;{% trans "Edit this configurations"  %}</a>

                        <table width="90%">
                            <tr>
                                <td>MeSH:<br>
                                {% if obj.mesh %}
                                <input type="checkbox" name="mesh" value="" checked="true" disabled>
                                {% else %}
                                <input type="checkbox" name="mesh" value="" disabled>
                                {% endif %}
                                </td>

                                <td>Saude Publica:<br>
                                {% if obj.saude_publica %}
                                    <input type="checkbox" name="saude_publica" value="" checked="true" disabled>
                                {% else %}
                                    <input type="checkbox" name="saude_publica" value="" disabled>
                                {% endif %}
                                </td>

                                <td>Homeopatia:<br>
                                {% if obj.homeopatia %}
                                    <input type="checkbox" name="homeopatia" value="" checked="true" disabled>
                                {% else %}
                                    <input type="checkbox" name="homeopatia" value="" disabled>
                                {% endif %}
                                </td>

                                <td>Vigilância Sanitária:<br>
                                {% if obj.reforma_saude %}
                                    <input type="checkbox" name="reforma_saude" value="" checked="true" disabled>
                                {% else %}
                                    <input type="checkbox" name="reforma_saude" value="" disabled>
                                {% endif %}
                                </td>
                            </tr>

                            <tr>
                                <td>Repidisca:<br>
                                {% if obj.repidisca %}
                                    <input type="checkbox" name="repidisca" value="" checked="true" disabled>
                                {% else %}
                                    <input type="checkbox" name="repidisca" value="" disabled>
                                {% endif %}
                                </td>

                                <td>Não indexavel:<br>
                                {% if obj.nao_indexavel %}
                                    <input type="checkbox" name="nao_indexavel" value="" checked="true" disabled>
                                {% else %}
                                    <input type="checkbox" name="nao_indexavel" value="" disabled>
                                {% endif %}
                                </td>

                                <td>Pré-codificado:<br>
                                {% if obj.pre_codificado %}
                                    <input type="checkbox" name="pre_codificado" value="" checked="true" disabled>
                                {% else %}
                                    <input type="checkbox" name="pre_codificado" value="" disabled>
                                {% endif %}
                                </td>

                                <td>Exploded:<br>
                                {% if obj.exploded %}
                                    <input type="checkbox" name="exploded" value="" checked="true" disabled>
                                {% else %}
                                    <input type="checkbox" name="exploded" value="" disabled>
                                {% endif %}
                                </td>

                            </tr>

                            <tr>
                                <td>Geográfico:<br>
                                {% if obj.geografico %}
                                    <input type="checkbox" name="geografico" value="" checked="true" disabled>
                                {% else %}
                                    <input type="checkbox" name="geografico" value="" disabled>
                                {% endif %}
                                </td>

                                <td>Geog DeCS:<br>
                                {% if obj.geog_decs %}
                                    <input type="checkbox" name="geog_decs" value="" checked="true" disabled>
                                {% else %}
                                    <input type="checkbox" name="geog_decs" value="" disabled>
                                {% endif %}
                                </td>

                                <td>PT LILACS:<br>
                                {% if obj.pt_lilacs %}
                                    <input type="checkbox" name="pt_lilacs" value="" checked="true" disabled>
                                {% else %}
                                    <input type="checkbox" name="pt_lilacs" value="" disabled=>
                                {% endif %}
                                </td>

                                <td>Desastre:<br>
                                {% if obj.desastre %}
                                    <input type="checkbox" name="desastre" value="" checked="true" disabled>
                                {% else %}
                                    <input type="checkbox" name="desastre" value="" disabled>
                                {% endif %}
                                </td>

                            </tr>

                        </table>

                        <ul>

                    {% endfor %}
                {% else %}
                    <ul>

                        <a href="{% url 'create_legacy_qualif' %}/?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}&identifier_id={{ id_concept_new.identifier_id }}">
                        <i class='icon-file'></i>&nbsp;{% trans "Create this configurations"  %}</a>

                        <table width="90%">
                            <tr>
                                <td>MeSH:<br><input type="checkbox" name="mesh" value="" disabled=></td>
                                <td>Saude Publica:<br><input type="checkbox" name="saude_publica" value="" disabled=""></td>
                                <td>Homeopatia:<br><input type="checkbox" name="homeopatia" value="" disabled=""></td>
                                <td>Vigilância Sanitária:<br><input type="checkbox" name="reforma_saude" value="" disabled=""></td>
                            </tr>

                            <tr>
                                <td>Repidisca:<br><input type="checkbox" name="repidisca" value="" disabled=""></td>
                                <td>Não indexavel:<br><input type="checkbox" name="nao_indexavel" value="" disabled=""></td>
                                <td>Pré-codificado:<br><input type="checkbox" name="pre_codificado" value="" disabled=""></td>
                                <td>Exploded:<br><input type="checkbox" name="exploded" value="" disabled=""></td>
                            </tr>

                            <tr>
                                <td>Geográfico:<br><input type="checkbox" name="geografico" value="" disabled=""></td>
                                <td>Geog DeCS:<br><input type="checkbox" name="geog_decs" value="" disabled=""></td>
                                <td>PT LILACS:<br><input type="checkbox" name="pt_lilacs" value="" disabled=""></td>
                                <td>Desastre:<br><input type="checkbox" name="desastre" value="" disabled=""></td>
                            </tr>

                        </table>
                    </ul>
                {% endif %}

            </div>

        </div>

        <a href="{% url 'list_qualifier' %}?ths={% if request.GET.ths %}{{ request.GET.ths }}{% else %}{{ actions.choiced_thesaurus }}{% endif %}" class="btn btn-large btn-danger">{% trans "Cancel" %}</a>

    </div>


{% endblock %}

{% block extrajs %}
   <script src="{% static 'js/jquery.formset.js' %}"></script>
   <script src="{% static 'js/bootstrap-datepicker.min.js' %}"></script>
   <script src="{% static 'js/bootstrap-collapse.js' %}"></script>

   {% if LANGUAGE_CODE != 'en' %}
       <script src="{% static ''%}js/bootstrap-datepicker.{{LANGUAGE_CODE}}.min.js"></script>
   {% endif %}

    <script language="JavaScript">
        jQuery(document).ready(function() {
            $(window).scroll(function () {
                set = $(document).scrollTop()+"px";
                jQuery('#float-banner').animate(
                    {top:set},
                    {duration:1000, queue:false}
                );
            });
        });
    </script>


   <!-- Search process -->
    <script language="JavaScript">
    <!--
    var TRange=null

    function findString (str) {
        if (parseInt(navigator.appVersion)<4) return;
        var strFound;

        if (window.find) {
    // CODE FOR BROWSERS THAT SUPPORT window.find

            strFound=self.find(str);
            if (strFound && self.getSelection && !self.getSelection().anchorNode) {
                strFound=self.find(str)
            }
            if (!strFound) {
                strFound=self.find(str,0,1)
                while (self.find(str,0,1)) continue
            }
        }
        else if (navigator.appName.indexOf("Microsoft")!=-1) {
            // EXPLORER-SPECIFIC CODE
            if (TRange!=null) {
                TRange.collapse(false)
                strFound=TRange.findText(str)
                if (strFound)
                    TRange.select()
            }
            if (TRange==null || strFound==0) {
                TRange=self.document.body.createTextRange()
                strFound=TRange.findText(str)
                if (strFound) TRange.select()
                }
            }
            else if (navigator.appName=="Opera") {
                alert ("Opera browsers not supported, sorry...")
                return;
            }
            if (!strFound) alert ('{% trans "No results found" %}')
                return;
            }

        $('#id_t1').keypress(function(e) {
            if(e.which == 13) {
              e.preventDefault();
              console.log('Não vou enviar');
            }
        });


        $(document).ready(function(){
            $(window).scroll(function(){
                if ($(this).scrollTop() > 100) {
                    $('a[href="#top"]').fadeIn();
                } else {
                    $('a[href="#top"]').fadeOut();
                }
            });

            $('a[href="#top"]').click(function(){
                $('html, body').animate({scrollTop : 0},800);
                return false;
            });
        });


        var menuId = location.hash.substring(1);
        $( document ).ready(function() {
        if (menuId) {
            var menu = $('#myTab');
            var current = $("li[id='" + menuId + "']");
            if(!current.hasClass("current")){
            $('.current').removeClass('current');
            current.addClass("current");
            $('.pbox:visible').hide();
            $('#' + menuId + '.pbox').show(600);
            history.pushState(null, null, '#' + menuId);
        }
        }
        });

    //-->
    </script>

    <script>
        // Faz com que apos refresh da pagina retorne para mesma aba
        $('a[data-toggle="tab"]').on('show.bs.tab', function (e) {
           localStorage.setItem('activeTab', $(e.target).attr('href'));
        });
        var activeTab = localStorage.getItem('activeTab');
        console.log(activeTab);

        if (activeTab) {
           $('a[href="' + activeTab + '"]').tab('show');
        }

    </script>


{% endblock %}