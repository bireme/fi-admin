{% load i18n %}

<!-- INDEXING FORMSET -->
<div id='tab-descriptors' class="tab-pane">

    <fieldset id="descriptors" class="row">
        <table class="table table-condensed table-striped span8">
            <thead>
                <th>{% trans "Descriptors" %}</th>
                <th>{% trans "Status" %}</th>
                <th>{% trans "Primary?" %}</th>
                {% if user_can_edit %}
                    <th>{% trans "Delete?" %}</th>
                {% endif %}
            </thead>
            <tbody>

            {% if descriptor_list %}
                {% for descriptor in descriptor_list %}
                    <tr>
                        <td>{{ descriptor.text }}</td>
                        <td>
                            {% if descriptor.status == 0 %}
                                <span title="{% trans 'Pending' %}"><i class="icon-minus-sign status-pending"></i></span>
                            {% elif descriptor.status == 1 %}
                                <span title="{% trans 'Admitted' %}"><i class="icon-ok-sign status-ok"></i></span>
                            {% elif descriptor.status == 2 %}
                                <span title="{% trans 'Refused' %}"><i class="icon-ban-circle status-del"></i></span>
                            {% elif descriptor.status == 3 %}
                                <span title="{% trans 'Deleted' %}"><i class="icon-minus-sign status-del"></i></span>
                            {% endif %}
                        </td>
                        <td></td>
                    </tr>
                {% endfor %}
            {% endif %}

            {% if user_can_edit %}
                {{ formset_descriptor.management_form }}

                {% for form in formset_descriptor %}
                    <tr id="descriptor-{{ forloop.counter0 }}" class="descriptor-row{% if form.errors %} error{% endif %} formset-row">
                        {% for hidden in form.hidden_fields %}
                            {{ hidden }}
                        {% endfor %}
                        {% for field in form.visible_fields %}
                            {% if field.name == 'status' and not user_can_change_status %}
                                <input type="hidden" id="{{ field.auto_id }}" name="{{ field.html_name }}" value="0" class="keep-field-value" />
                                <td></td>
                            {% elif field.name == 'code' %}
                                {{ field.as_hidden }}
                            {% elif field.name == 'text' %}
                                <td class="span9">
                                    {{ field.as_hidden }}
                                    <div class="input-xxlarge uneditable-input {% if field.value == None %}placeholder-style{% endif %}" id="label_{{ field.html_name }}" onclick="javascript:decs_search(this)">
                                        {% spaceless %}
                                        {% if field.value == None or field.value == '' %}
                                            {% trans "Select by search" %}
                                        {% else %}
                                            {{ field.value}}
                                        {% endif %}
                                        {% endspaceless %}
                                    </div>
                                </td>
                            {% elif field.name != 'DELETE' %}
                                <td class="span6">
                                    {{ field }}
                                    {{ field.errors }}
                                </td>
                            {% endif %}
                        {% endfor %}
                        <td class="span6">
                            {% if form.instance.pk %}{{ form.DELETE }}{% endif %}
                        </td>
                    </tr>
                {% endfor %}
            {% endif %}
            </tbody>
            </table>
        </fieldset>

        {% for fieldset in form.fieldsets %}
            {% if fieldset.name == 'indexing' %}
                {% include "biblioref/fieldset_include.html" %}
            {% endif %}
        {% endfor %}

</div>
<!-- /INDEXING FORMSET -->
